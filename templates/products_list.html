{% extends 'base.html' %}
{% block title %}Productos{% endblock %}
{% block content %}
  <div class="dashboard">
    <aside class="sidebar">
      <ul>
        <li><a href="{{ url_for('main.dashboard_emprendedor') }}">Dashboard</a></li>
        <li><a href="{{ url_for('main.productos') }}">Productos</a></li>
        <li><a href="{{ url_for('main.pedidos') }}">Pedidos</a></li>
        <li><a href="{{ url_for('main.finanzas') }}">Finanzas</a></li>
      </ul>
    </aside>
    <section class="content">
      <h2>Productos</h2>

      <!-- barra de búsqueda -->
      <form method="get" action="{{ url_for('main.productos') }}" class="search-form">
        <input name="q" placeholder="Buscar por nombre o código" value="{{ query or '' }}">
        <button type="submit">Buscar</button>
      </form>

      <!-- formulario creación product (simple) -->
      <div class="card">
        <h3>Registrar producto</h3>
        <form method="post" enctype="multipart/form-data">
          <label>Nombre</label><input name="nombre" required>
          <label>Precio</label><input name="precio" type="number" step="0.01" required>
          <label>Descripción</label><textarea name="descripcion"></textarea>
          <label>Cantidad</label><input name="cantidad" type="number" value="0">
          <label>Imagen</label><input name="imagen" type="file" accept="image/*">
          <button type="submit">Crear</button>
        </form>
      </div>

      <!-- lista de productos en rectángulos -->
      <div class="product-grid">
        {% for p in productos %}
          <div class="product-card">
            {% if p.imagen_filename %}
              <img src="{{ url_for('static', filename='uploads/product_images/' + p.imagen_filename) }}" alt="{{ p.nombre }}">
            {% else %}
              <div class="placeholder-img">No imagen</div>
            {% endif %}
            <div class="product-info">
              <h4>{{ p.nombre }}</h4>
              <p>Código: {{ p.codigo }}</p>
              <p>Precio: ${{ "%.2f"|format(p.precio) }}</p>
              <p>Disponibles: {{ p.cantidad }}</p>
              <form method="post" action="{{ url_for('main.eliminar_producto', product_id=p.id) }}" onsubmit="return confirm('Eliminar producto?')">
                <button type="submit">Eliminar</button>
              </form>
            </div>
          </div>
        {% endfor %}
      </div>
    </section>
  </div>
{% endblock %}
